{"version":3,"sources":["../../../src/modules/menu/MenuConfigurationPublic.js"],"names":["createMenu","MenuConfig","actionNames","actions","Object","keys","map","key","push","registerMenuReducer","area","settings","subArea","sortIndex","actionHandler","data","createEntry","item","children","undefined","child","result","entry","def","highLight","component","styleClass","intlSortAlphabetically","length","routeName","hash","callback","createMenuEntry","currentDef","unauthenticated","action","type","substr","menuUnauthenticated","globalState","payload","getState","Array","isArray","state","$set"],"mappings":"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","file":"MenuConfigurationPublic.js","sourcesContent":["import MenuConfigurationInternal from './MenuConfigurationInternal'\nimport update from 'react-addons-update'\n\nfunction createMenu(MenuConfig) {\n    var actionNames = [\n        //AuthConstants.ActionConstants.AUTHENTICATED,\n        //AuthConstants.ActionConstants.UNAUTHENTICATED\n    ]\n    //uniqueActionNames(actionNames, actionNamesArray)\n\n    // take actions from config and assign them, instead of submitting them separately\n    // the actions are what triggers either the update of the menu area, either by using\n    // a static menu def or a localised menu reducer\n    if (MenuConfig.actions) {\n        // console.log('Initialising menu, checking actions')\n\n        Object.keys(MenuConfig.actions)\n              .map((key) => {\n                  // console.log('Initialising menu, checking actions', key)\n                  actionNames.push(key)\n              })\n    }\n\n    // console.log('GENERICMENU createGenericMenu ', MenuConfig)\n    // console.log('GENERICMENU createGenericMenu', actionNames)\n    MenuConfigurationInternal.registerMenuReducer({\n        area: MenuConfig.settings.area || 'main',\n        subArea: MenuConfig.settings.subArea,\n        sortIndex: MenuConfig.settings.sortIndex,\n        actionHandler: (data) => {\n            // console.log('GENERICMENU ACTION HANDLER', data)\n            function createEntry(item) {\n                //console.log('createEntry', item)\n                var children = []\n                if (item.children !== undefined) {\n                    item.children.map((child) => {\n                        var result = createEntry(child)\n                        result.map((entry) => {\n                            children.push(entry)\n                        })\n                    })\n                }\n                var def = {\n                    highLight: item.highLight,\n                    sortIndex: item.sortIndex,\n                    component: item.component,\n                    styleClass: item.styleClass\n                }\n                if (item.intlSortAlphabetically === true) {\n                    def.intlSortAlphabetically = true\n                }\n                if (children.length) {\n                    def.children = children\n                }\n\n                if (item.routeName !== undefined) {\n                    def.hash = item.routeName\n                }\n\n                if (item.hash !== undefined) {\n                    def.hash = item.hash\n                }\n\n                if (item.callback !== undefined && typeof item.callback === 'function') {\n                    def.callback = item.callback\n                }\n                return [MenuConfigurationInternal.createMenuEntry(def)]\n            }\n\n            // if (MenuConfig.isAuthenticatedSelector(data.getState())) {\n            //     //console.log('GENERICMENU ACTION HANDLER CREATING AUTHENTICATED MENU')\n            //     var menuAuthenticated = []\n            //     MenuConfig.authenticated.map((item) => {\n            //         var result = []\n            //         if (item.creator !== undefined) {\n            //             result = getMenuEntryCreator(item.creator)(item, data)\n            //         } else {\n            //             result = createEntry(item)\n            //         }\n            //         result.map((entry) => {\n            //             menuAuthenticated.push(entry)\n            //         })\n            //     })\n            //     console.log('menuAuthenticated', menuAuthenticated)\n            //\n            //     return update(data.state, {$set: menuAuthenticated})\n            // } else {\n            //console.log('GENERICMENU ACTION HANDLER CREATING UNAUTHENTICATED MENU')\n\n            var currentDef = MenuConfig.unauthenticated\n            // console.log('xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx', MenuConfig, data.action.type.substr(-5))\n            // remove menu suffix from action and check if in menu definition exists an entry for that\n            if (MenuConfig.actions[data.action.type.substr(0, data.action.type.length - 5)]) {\n                currentDef = MenuConfig.actions[data.action.type.substr(0, data.action.type.length - 5)]\n            }\n\n            var menuUnauthenticated = []\n\n            if (typeof currentDef === 'function') {\n                currentDef = currentDef({\n                    globalState: data.action.payload.getState(),\n                    action: data.action\n                })\n            }\n            // console.log('xxxxxxxxxxxxxxxmenu def is then ', currentDef)\n\n            if (Array.isArray(currentDef)) {\n                currentDef.map((item) => {\n                    const result = createEntry(item)\n                    result.map((entry) => {\n                        menuUnauthenticated.push(entry)\n                    })\n                })\n            }\n            // console.log('menuUnauthenticated', menuUnauthenticated)\n            return update(data.state, {$set: menuUnauthenticated})\n        },\n        actionNames: actionNames\n    })\n}\n\nexport default {\n    createMenuEntry: MenuConfigurationInternal.createMenuEntry,\n    createMenu\n}\n"]}